{
  "hash": "7eb67f7c08f92f97925d80a369878655",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Samling 8. april.Repetisjon\"\nauthor: \"Njål Foldnes\"\nfooter:  \"[hjem](https://njaalf.github.io/MPS-140/)\"\n   \nbibliography: ../references.bib \nformat: \n  revealjs: \n    toc: true\n    toc-depth: 1\n    multiplex: true\n    transition: fade\n    slide-number: true\n    theme: slides.scss\n    chalkboard: true\nrevealjs-plugins:\n  - revealjs-text-resizer\n    \neditor: visual\nexecute:\n  echo: true\n  message: false\n  warning: false\n  freeze: auto \n---\n\n\n\n\n\n\n# Beskrivende statistikk\n\n## Envariabelstatistikk vha nøkkeltall\n\nKontinuerlige variable\n\n-   Sentraltendens:Gjennomsnitt eller median\n\n-   Spredning: Standardavvik eller interkvartilbredde\n\nKategoriske variabler:\n\n-   Frekvenstabell\n\n## Envariabelstatistikk vha nøkkeltall, R\n\nKontinuerlig:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych); data(bfi)\nbfi <- bfi[complete.cases(bfi), ]#remove missing row-wise\nmean(bfi$age); median(bfi$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 29.51029\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 26\n```\n\n\n:::\n\n```{.r .cell-code}\nsd(bfi$age); IQR(bfi$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10.66422\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15\n```\n\n\n:::\n:::\n\n\n\n\n\n\nKategorisk:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(bfi$gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   1    2 \n 735 1501 \n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Standardavvik-regel\n\nI en normalfordeling så er 95% av observasjonene mindre enn to standardavvik unna gjennomsnittet. \"Uvanlig\": mer enn 2 standardavvik vekk fra snittet.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nggplot(data = data.frame(x = c(-3, 3)), aes(x)) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 1)) + ylab(\"\") +\n  scale_y_continuous(breaks = NULL)+ggtitle(\"Standard normalfordeling N(0,1)\")\n```\n\n::: {.cell-output-display}\n![](slides5b_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## Envariabelstatistikk: Grafer\n\nFor kontinuerlige variabler: histogram eller boksplott\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(bfi$age)\n```\n\n::: {.cell-output-display}\n![](slides5b_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## boksplott for å sammenlikne grupper\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(bfi$age~bfi$gender)\n```\n\n::: {.cell-output-display}\n![](slides5b_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## Envariabelstatistikk: Stolpediagram for kategorisk variabel\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqplot(factor(bfi$education))+geom_bar()\n```\n\n::: {.cell-output-display}\n![](slides5b_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## Tovariabelstatistikk: korrelasjon\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#the older the more agreeable\nsumA <- 7-bfi$A1+bfi$A2+bfi$A3+bfi$A4+bfi$A5\ncor(sumA,bfi$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.144486\n```\n\n\n:::\n\n```{.r .cell-code}\nqplot(bfi$age, sumA)+geom_smooth(method=\"lm\")\n```\n\n::: {.cell-output-display}\n![](slides5b_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## Tovariabelstatistikk: Enkel regresjon\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(sumA~bfi$age) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sumA ~ bfi$age)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.6427  -2.7269   0.7187   3.2006   7.6825 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 21.654892   0.273855  79.074  < 2e-16 ***\nbfi$age      0.060236   0.008728   6.902 6.68e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.4 on 2234 degrees of freedom\nMultiple R-squared:  0.02088,\tAdjusted R-squared:  0.02044 \nF-statistic: 47.63 on 1 and 2234 DF,  p-value: 6.675e-12\n```\n\n\n:::\n:::\n\n\n\n\n\n\nFor hvert år alder øker så forventes en økning i sumA på 0.06\n\n# Inferense\n\n## Envariabelstatistikk: Inferens om gjennomsnitt\n\nTeste om menn og kvinner har samme alder i populasjonen $H_0: \\mu_M=\\mu_K$ vs $H_A: \\mu_M \\neq \\mu_K$. Da brukes en $t$-test.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(bfi$age~bfi$gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  bfi$age by bfi$gender\nt = -2.2367, df = 1481.8, p-value = 0.02546\nalternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0\n95 percent confidence interval:\n -2.0012630 -0.1311404\nsample estimates:\nmean in group 1 mean in group 2 \n       28.79456        29.86076 \n```\n\n\n:::\n:::\n\n\n\n\n\n\nVi har støtte for å hevde at det er forskjellig snittalder menn vs kvinner (når signifikansnivået $\\alpha=.05$)\n\n## Type I og II feil i hypotesetesting\n\nType I feil: Å forkaste nullhypotesen når den er sann. Dette skjer 1 av 20 ganger i det lange løp, når signifikansnivået er 5%.\n\nType II feil: Å ikke forkaste nullhypotesen når den er usann. Vi kan minske sjansen for dette ved å ha et stort utvalg.\n\nTestens styrke: Sjansen for at man ikke begår Type II feil når $H_0$ er usann. Styrken øker når utvalgsstørrelsen øker.\n\n## Konfidensintervall\n\nFor gjennomsnitt så kan vi beregne et 95% *konfidensintervall*. Vi er 95% sikre på at populasjonsverdin ligger i intervallet\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(bfi$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  bfi$age\nt = 130.85, df = 2235, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 29.06803 29.95255\nsample estimates:\nmean of x \n 29.51029 \n```\n\n\n:::\n:::\n\n\n\n\n\n\nKonfidensintervall for alder er (29.07, 29.95).\n\n## Enkel Regresjon\n\nEnkel regresjon predikerer verdien på en *avhengig variabel* y som en lineær funksjon av en *uavhengig variabel* x.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(sumA~bfi$age) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sumA ~ bfi$age)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.6427  -2.7269   0.7187   3.2006   7.6825 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 21.654892   0.273855  79.074  < 2e-16 ***\nbfi$age      0.060236   0.008728   6.902 6.68e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.4 on 2234 degrees of freedom\nMultiple R-squared:  0.02088,\tAdjusted R-squared:  0.02044 \nF-statistic: 47.63 on 1 and 2234 DF,  p-value: 6.675e-12\n```\n\n\n:::\n:::\n\n\n\n\n\n\nJa, alder er signifikant, men effekten er nesten uten praktisk verdi. $R^2=.02$ er den forklarte variansen. Så 2% av variasjon i agreeableness kan forklares av alder.\n\n## Multippel Regresjon\n\nFremdeles en avhengig variabel Y. Men nå har vi flere uavhengige/prediktorer $X_1, \\ldots, X_k$.\n\n*Ceteris paribus*: Alt annet likt. Dvs vi får effekt av hver X, kontrollert for at de andre X'ene ikke forandrer seg.\n\nDummykoding: Kategoriske variable kan kodes med dummyer som er 0/1. Hver dummy gir kontrast til referansekategorien.\n\n## Effekt av Neuroticism on Agreeableness, controlled for gender and age\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsumN <- bfi$N1+bfi$N2+bfi$N3+bfi$N4+bfi$N5\nlm(sumA~sumN+bfi$age+bfi$gender) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sumA ~ sumN + bfi$age + bfi$gender)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.0320  -2.4125   0.5453   3.0154   9.3515 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 20.447369   0.461709  44.286  < 2e-16 ***\nsumN        -0.141978   0.015098  -9.404  < 2e-16 ***\nbfi$age      0.047090   0.008414   5.596 2.46e-08 ***\nbfi$gender   2.290064   0.191216  11.976  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.211 on 2232 degrees of freedom\nMultiple R-squared:  0.1041,\tAdjusted R-squared:  0.1029 \nF-statistic: 86.48 on 3 and 2232 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\n\nEn økning i neuroticism sumskår på 1 poeng er forventet å minske sumskår A med .14. Modellen forklarer 10.3% av variasjonen in A.\n\n## Forutsetninger for regresjon\n\n-   Homoskedastiske feil-ledd. Sjekkes ved å plotte residualene og se at de har lik varians uavhengig av den tilpassete y verdi\n\n-   Linearitet. Sjekkes med plott\n\n-   Hvis $n$ er lav: Normalfordelte feil-ledd. Sjekkes i QQ plot\n\n-   Vi bruker *performance::check_model()* og sjekker visuelt\n\n## ANOVA\n\nHvis vi har mange grupper kan vi sjekk om gjennomsnittene er like i alle gruppen. Enten bruke *aov()* funksjonen eller bare multippel regresjon og $F$ statistikken. $H_0$: snittet er likt i alle grupper, $H_A$ snittet er ulikt i noen grupper.\n\nEr agreeableness den samme i alle utdanningsnivå?\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi$education <- factor(bfi$education)# si ifra at dette er grupper og ikke intervallskala\naov(sumA~factor(bfi$education)) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor(bfi$education)    4    478  119.50   6.101 7.01e-05 ***\nResiduals             2231  43699   19.59                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n\np-verdi \\< .05 så vi forkaster $H_0$! Det er ikke samme Agreeableness i all utdanningsnivå\n\n## ANOVA med multippel regresjon\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(sumA~bfi$education) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sumA ~ bfi$education)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.7978  -2.7880   0.3269   3.2120   7.4141 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     22.5859     0.3145  71.810  < 2e-16 ***\nbfi$education2   0.2021     0.4210   0.480 0.631202    \nbfi$education3   1.2119     0.3422   3.542 0.000406 ***\nbfi$education4   0.4055     0.3944   1.028 0.304002    \nbfi$education5   1.0872     0.3908   2.782 0.005449 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.426 on 2231 degrees of freedom\nMultiple R-squared:  0.01082,\tAdjusted R-squared:  0.009047 \nF-statistic: 6.101 on 4 and 2231 DF,  p-value: 7.009e-05\n```\n\n\n:::\n:::\n\n\n\n\n\n\nF-statistikken har samme p-verdi! I tillegg får vi effektene vs referansekategorien 1.\n\n## Logistisk regresjon\n\nNår den avhengige variabelen er 0/1 så predikerer vi verdien til log-odds for $P(Y=1)=p$: $$ log(\\frac{p}{p-1})=a+b_1 X_1+ b_2X_2+\\epsilon$$ Kan agreeableness forutsi kjønn (når vi kontrollerer for alder) ?\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfemale <- ifelse(bfi$gender ==2, 1, 0)\nglm(female ~ sumA+bfi$age, family=\"binomial\") %>% coefficients()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)        sumA     bfi$age \n-1.84708532  0.10653968  0.00331439 \n```\n\n\n:::\n:::\n\n\n\n\n\n\nJa, jo høyere A, jo større er sjansen for at det er en dame.\n\n# Psykologiske konstrukter\n\n## Skalaens reliabilitet\n\nHvor stabile er målingene til skalaen? Hvis vi gjør spørreundersøkelsen på ny, hva er korrelasjon mellom gammel og ny score?\n\nDette tallet kalles *reliabilitet* og måles oftest ved Cronbach's alpha. Bør være minst 0.7-0.8\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::alpha(select(bfi, paste0(\"A\", 1:5)), check.keys=T) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nReliability analysis   \n raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r\n      0.71      0.71    0.68      0.33 2.5 0.0099  4.7 0.89     0.34\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Skalaens validitet\n\nDette er en kjerneegenskap. Valide instrument måler det de er ment å måle, og målingene brukes på en måte som gjenspeiler dette.\n\nEt veldig stort og filosofisk felt. Det finnes flere typer validitet og etablering av validitet er en prosess med mange refleksjoner. Her er en nyttig [link](http://korbedpsych.com/R09eValidity.html)\n\n## Latente variable\n\nEn *latent variabel* er ikke observerbar, men vi kan måle den indirekte vha indikatorer= items i spørreskjema. Et sett av items som måler en faktor må skilles fra andre items som måler andre faktorer. Det får vi til med EFA.\n\nEFA:\n\n-   finne antall faktorer i instrument/skala (parallel analyse)\n-   finne ut hvilke items som hører sammen i grupper som reflekterer hver sin faktor (fa() funksjonen i psych)\n\nCFA: Da vet vi indikatorene og vi bruker *lavaan* til å beregne faktorladninger og regresjoner mellom latente variabler.\n",
    "supporting": [
      "slides5b_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}